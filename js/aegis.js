(function(n,q){"object"===typeof exports&&"undefined"!==typeof module?module.exports=q():"function"===typeof define&&define.amd?define(q):(n=n||self,n.Aegis=q())})(this,function(){function n(a,b){function c(){this.constructor=a}B(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}function q(){for(var a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;a=Array(a);var d=0;for(b=0;b<c;b++)for(var e=arguments[b],g=0,h=e.length;g<h;g++,d++)a[d]=e[g];return a}function fa(a){a=
    Array.isArray(a)?a:[a];return a.map(function(a,c){return Object.getOwnPropertyNames(a).map(function(b){return K(b)+"["+c+"]="+K(a[b])}).join("&")}).join("&")+(a.length?"&count="+a.length:"")}function K(a){try{return encodeURIComponent(decodeURIComponent(a))}catch(b){return""}}function L(){if(-1<r)return r;r=t.other;if(-1<M.indexOf("tbs")){var a=M.match(/tbs\/([\d\.]+)/);r=a&&a[1]&&36541<=parseInt(a[1],10)?t.newX5:t.oldX5}return r}function m(a,b){return"string"===typeof a?a.split("?")[b?1:0]||"":a}
    function k(a){return/^https/.test(a)}function N(){var a;if(a="undefined"!==typeof window.performance)a=window.Performance,a="function"===typeof a&&/native code/.test(a.toString());return a&&"function"===typeof performance.clearResourceTimings&&"function"===typeof performance.getEntriesByType&&"function"===typeof performance.now}function O(a){return ha.some(function(b){return-1!==a.indexOf(b)})}function C(a){P.forEach(function(b){b(a)})}function ia(){if(!Q){Q=!0;var a=window.onerror;window.onerror=
        function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b[4]&&C({msg:b[4],level:f.ERROR});a&&a.call.apply(a,q([window],b))};window.addEventListener("unhandledrejection",function(a){a=a&&v(a.reason);C({msg:"PROMISE_ERROR: "+a,level:f.PROMISE_ERROR})});window.document.addEventListener("error",function(a){if(a&&a.target&&a.srcElement){var b=a.target||a.srcElement;a=b.src||b.href;b=b.tagName;if(a&&b){a={msg:b+" load fail: "+a,level:f.INFO};switch(b.toLowerCase()){case "script":a.level=f.SCRIPT_ERROR;
        break;case "link":a.level=f.CSS_ERROR;break;case "audio":case "video":a.level=f.MEDIA_ERROR;break;default:return}C(a)}}},!0)}}function R(a){S.forEach(function(b){b(a)})}function ja(){var a=performance.getEntriesByType("resource"),b=a.slice(D);D=a.length;a=0;for(var c=b.length;a<c;a++){var d=b[a];-1!==ka.indexOf(d.initiatorType)&&(console.log(d),d={url:m(d.name),method:"get",duration:Number(d.duration.toFixed(2)),status:200,type:"static",isHttps:k(d.name),urlQuery:m(d.name,!0),x5Type:L(),X5ContentType:d.X5ContentType,
        X5HttpStatusCode:d.X5HttpStatusCode,x5ImgDecodeStatus:d.x5ImgDecodeStatus,x5ErrorCode:d.x5ErrorCode,x5LoadFromLocalCache:d.x5LoadFromLocalCache,x5ContentLength:d.x5ContentLength,domainLookup:d.domainLookupEnd-d.domainLookupStart,connectTime:d.connectEnd-d.connectStart},R(d))}}function T(a,b){var c=[],d;for(d in a)c.push(d+"="+a[d]);E.forEach(function(a){a({url:b.config.performanceUrl+"?"+c.join("&")})});E.length=0}function la(a){var b=["script","style","link","br"],c=[],d=new MutationObserver(function(a){var d=
        {roots:[],rootsDomNum:[],time:performance.now()};a.forEach(function(a){a&&a.addedNodes&&a.addedNodes.forEach&&a.addedNodes.forEach(function(a){1!==a.nodeType||-1!==b.indexOf(a.nodeName.toLocaleLowerCase())||U(a,d.roots)||(d.roots.push(a),d.rootsDomNum.push(V(a)||0))})});d.roots.length&&c.push(d)});d.observe(document,{childList:!0,subtree:!0});setTimeout(function(){d.disconnect();var b=0,g=NaN,h=!1;c.forEach(function(a){for(var d=0;d<a.roots.length;d++){var c;if(c=a.rootsDomNum[d]>b)if((c=a.roots[d])&&
        c.getBoundingClientRect){c=c.getBoundingClientRect();var e=window.innerHeight,h=window.innerWidth;c=0<=c.left&&c.left<h&&0<=c.top&&c.top<e}else c=!1;c&&(b=a.rootsDomNum[d],g=a.time)}});window.performance.getEntriesByType("resource").forEach(function(a){"img"===a.initiatorType&&(a.fetchStart<g||a.startTime<g)&&a.responseEnd>g&&(h=!0,g=a.responseEnd)});a&&a(h?g:g+25)},3E3)}function U(a,b){return a&&a!==document.documentElement?-1!==b.indexOf(a)?!0:U(a.parentElement,b):!1}function V(a){var b=0;if(a&&
        1===a.nodeType&&(b++,(a=a.children)&&a.length))for(var c=0;c<a.length;c++)b+=V(a[c]);return b}function x(a){W.forEach(function(b){b(a)})}function y(a){X.forEach(function(b){b(a)})}function na(){if("function"===typeof window.fetch){var a=window.fetch;window.fetch=function(b,c){var d=Date.now();return a(b,c).then(function(a){try{var e=a.headers?a.headers.get("content-type"):"";if(a.ok&&"string"===typeof e&&O(e)){var h={url:m(a.url),isHttps:k(a.url),method:c&&c.method||"get",duration:Date.now()-d,type:"static",
        status:a.status};x(h)}else a.clone().text().then(function(e){y({msg:b+" "+e,level:f.API_RESPONSE});var g=Y(e),h={url:m(a.url),isHttps:k(a.url),method:c&&c.method||"get",duration:Date.now()-d,type:"fetch",ret:g||"unknown",status:a.status};x(h);"0"!==g&&"unknown"!==g&&y({msg:"request url: "+b+" \n response: "+e,level:f.RET_ERROR})})}catch(F){}return a}).catch(function(a){var e={url:m(b),isHttps:k(b),method:c&&c.method||"get",duration:Date.now()-d,type:"fetch",status:600};x(e);throw a;})}}}function oa(){var a=
        window.XMLHttpRequest.prototype,b=a.open,c=a.send;a.open=function(){!this.__sendByAegis&&(this.aegisMethod=arguments[0]);return b.apply(this,arguments)};a.send=function(){var a=Date.now();!this.__sendByAegis&&this.addEventListener("loadend",function(){var b=this.responseURL,c={url:m(b),isHttps:k(b),status:this.status,method:this.aegisMethod||"get",type:"fetch",duration:Date.now()-a},d=this.getResponseHeader("content-type");if(400<=this.status||"string"!==typeof d||!O(d))try{y({msg:b+" "+this.response,
        level:f.API_RESPONSE}),c.ret=Y(this.response),"0"!==c.ret&&"unknown"!==c.ret&&y({msg:"request url: "+b+" \n response: "+this.response,level:f.RET_ERROR})}catch(F){c.ret="unknown"}else c.type="static",delete c.ret;x(c)});return c.apply(this,arguments)}}function pa(a){try{var b=window.localStorage.getItem("AEGIS_ID");b||(b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)}),window.localStorage.setItem("AEGIS_ID",b));a&&a(b||
        "")}catch(c){a&&a("")}}function qa(a){if("function"===typeof window.fetch){var b=window.fetch;window.fetch=function(c,d){Z(c)&&("object"===typeof d&&d?d.headers?d.headers instanceof Headers&&d.headers.append("X-Tjg-Json-Span-Context",z(a)):d.headers=new Headers({"X-Tjg-Json-Span-Context":z(a)}):d={headers:new Headers({"X-Tjg-Json-Span-Context":z(a)})});return b(c,d)}}}function ra(a){if(window.XMLHttpRequest){var b=window.XMLHttpRequest.prototype.send,c=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=
        function(){!this.__sendByAegis&&Z(arguments[1])&&(this.useTjg=!0);return c.apply(this,arguments)};window.XMLHttpRequest.prototype.send=function(){this.useTjg&&this.setRequestHeader("X-Tjg-Json-Span-Context",z(a));return b.apply(this,arguments)}}}function z(a){return JSON.stringify({ids:{trace_id:{high:G(),low:G()},span_id:G(),parent_id:0,flag:2},baggages:{aegis_session_id:a._sessionID}})}function G(){return parseInt(Array(53).fill(1).map(function(){return.5<Math.random()?1:0}).join(""),2)}function Z(a){var b=
        document.createElement("a");b.href=a;return location.origin===b.origin}function H(a,b){var c,d=[];return function(e,g){d.push(e);b&&d.length>=b?(g(d.splice(0,d.length)),c&&clearTimeout(c)):(c&&clearTimeout(c),c=setTimeout(function(){c=null;g(d.splice(0,d.length))},a))}}function sa(a){var b=!1,c=!1;setTimeout(function(){a.send({url:a.config.whiteListUrl},function(a){try{a=JSON.parse(a)||{},0===a.retcode&&(b=a.result.is_in_white_list),c=!0}catch(g){}},function(){c=!0})},50);var d=[];return function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              g){b?g(a.concat(d.splice(0)).map(function(a){a.level===f.INFO_ALL&&(a.level=f.INFO);return a})):(a=a.filter(function(a){if(a.level!==f.INFO&&a.level!==f.API_RESPONSE)return a.level===f.INFO_ALL&&(a.level=f.INFO),!0;c||(d.push(a),200<=d.length&&(d.length=200))}),a.length&&g(a))}}function ta(){var a={};return function(b,c){Array.isArray(b)?(b=b.filter(function(b){var c=!a[b.url];a[b.url]=!0;return c}),b.length&&c(b)):(!a[b.url]&&c(b),a[b.url]=!0)}}function I(a){if(!a||!a.reduce||!a.length)throw new TypeError("createPipeline \u65b9\u6cd5\u9700\u8981\u4f20\u5165\u81f3\u5c11\u6709\u4e00\u4e2a pipe \u7684\u6570\u7ec4");
        return 1===a.length?function(b,c){a[0](b,c||aa)}:a.reduce(function(a,c){return function(b,e){void 0===e&&(e=aa);return a(b,function(a){return c&&c(a,e)})}})}function ua(a,b){var c={fetch:[],static:[]},d=new FormData;Array.isArray(a)?a.forEach(function(a){c[a.type].push(a)}):c[a.type].push(a);d.append("payload",JSON.stringify(J({duration:c},b)));return d}function va(a,b,c){var d=document.createElement("script"),e=document.head;"function"===typeof b&&(c=b,b="");d.src=a;d.setAttribute("name",b);d.name=
        b;d.async=!0;d.onload=d.onreadystatechange=function(){d.readyState&&"loaded"!==d.readyState&&"complete"!==d.readyState||("function"===typeof c&&c(!1),e.removeChild(d))};d.onerror=function(){"function"===typeof c&&c(!0);e.removeChild(d)};e.appendChild(d)}function wa(){var a=/\b(iPad|iPhone|iPod)\b.*? OS ([\d_]+)/,b=u.other;/\bAndroid\s*([^;]+)/.test(ba)?b=u.android:a.test(ba)&&(b=u.ios);return b}function xa(a){function b(a){a=String(a).toLowerCase();return 0<=a.indexOf("2g")?l.net2g:0<=a.indexOf("3g")?
        l.net3g:0<=a.indexOf("4g")?l.net4g:0<=a.indexOf("wifi")?l.wifi:l.unknown}try{window.mqq&&window.mqq.device&&"function"==typeof window.mqq.device.getNetworkType&&window.mqq.support&&window.mqq.support("mqq.device.getNetworkType")?window.mqq.device.getNetworkType(function(b){-1==b&&(b=l.unknown);a(b)}):a(b(navigator.connection&&navigator.connection.type?navigator.connection.type:"unknown"))}catch(c){a(l.unknown)}}function ya(a,b){function c(a){m.push(a)}function d(a,b){void 0===a&&(a={});void 0===b&&
    (b={});k={conds:a,params:b}}var e=b.dbConfig,g=void 0===e?{}:e;e=b.url;var h=void 0===e?"https://aegis.qq.com/badjs":e;e=b.offlineLogExp;var f=void 0===e?3:e,l=b.id,w=b.uin,m=[],k=null;p.useAsyncPlugin(a,{exportsConstructor:"Flog",onAegisInit:function(a){a.lifeCycle.on("beforeReport",c);a.lifeCycle.on("uploadLogs",d)},onAegisInitAndPluginLoaded:function(a,e){a.lifeCycle.remove("beforeReport",c);a.lifeCycle.remove("uploadLogs",d);var F=Object.assign({lookupUrl:h+"/offlineAuto?id="+l+"&uin="+w,uploadUrl:h+
                "/offlineLog",preservedDay:f,id:l,uin:w},g,{sessionId:p._sessionID});try{var n=new e(F);m.forEach(function(a){n.add(a)});a.lifeCycle.on("beforeReport",function(a){void 0===a&&(a=[]);a.forEach(function(a){n.add(a)})});a.lifeCycle.on("uploadLogs",function(a,c){void 0===a&&(a={});void 0===c&&(c={});a=Object.assign({id:b.id,uin:b.uin},a);n.uploadLogs(a,c)});k&&(a.lifeCycle.emit("uploadLogs",k.conds,k.params),k=null)}catch(za){console.log(za)}}})}var B=function(a,b){B=Object.setPrototypeOf||{__proto__:[]}instanceof
        Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return B(a,b)},J=function(){J=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return J.apply(this,arguments)},Aa=function(){function a(){var a=this;this.emit=function(b,d){if(a){var c=a.__EventsList[b];if(c&&c.length){c=c.slice();for(var g=0;g<c.length;g++){var h=c[g];try{var f=h.callback.apply(a,
        [d]);1===h.type&&a.remove(b,h.callback);if(!1===f)break}catch(ma){throw ma;}}}return a}};this.__EventsList={}}a.prototype.indexOf=function(a,c){for(var b=0;b<a.length;b++)if(a[b].callback===c)return b;return-1};a.prototype.on=function(a,c,d){void 0===d&&(d=0);if(this){var b=this.__EventsList[a];b||(b=this.__EventsList[a]=[]);-1===this.indexOf(b,c)&&b.push({name:a,type:d||0,callback:c});return this}};a.prototype.one=function(a,c){this.on(a,c,1)};a.prototype.remove=function(a,c){if(this){var b=this.__EventsList[a];
        if(!b)return null;if(!c){try{delete this.__EventsList[a]}catch(e){}return null}b.length&&(a=this.indexOf(b,c),b.splice(a,1));return this}};return a}(),f;(function(a){a.INFO_ALL="-1";a.API_RESPONSE="1";a.INFO="2";a.ERROR="4";a.PROMISE_ERROR="8";a.AJAX_ERROR="16";a.SCRIPT_ERROR="32";a.IMAGE_ERROR="64";a.CSS_ERROR="128";a.CONSOLE_ERROR="256";a.MEDIA_ERROR="512";a.RET_ERROR="1024"})(f||(f={}));var t;(function(a){a[a.newX5=0]="newX5";a[a.oldX5=1]="oldX5";a[a.other=2]="other"})(t||(t={}));var M=navigator.userAgent.toLowerCase(),
        r=-1,ha="application/octet-stream application/xhtml+xml application/xml application/pdf application/pkcs12 application/javascript application/ecmascript application/vnd.mspowerpoint application/ogg text/html text/css text/javascript image audio video".split(" "),Ba=["ret","retcode","code"],Y=function(a){try{"string"===typeof a&&(a=JSON.parse(a));var b=Object.getOwnPropertyNames(a).filter(function(a){return-1!==Ba.indexOf(a.toLowerCase())});return b.length?""+a[b[0]]:"unknown"}catch(c){return"unknown"}},
        Ca=function(){var a=[],b=[];return function(c,d){if(d instanceof Error)return d.message&&d.stack&&-1===d.stack.indexOf(d.message)?d.message+" \n "+d.stack:d.stack;if("object"===typeof d&&null!==d){var e=a.indexOf(d);if(-1!==e)return"[Circular "+b[e]+"]";a.push(d);b.push(c||"root")}return d}},v=function(a){try{return(JSON.stringify(a,Ca(),4)||"undefined").replace(/"/gim,"")}catch(b){return"error happen when aegis stringify: \n "+b.message+" \n "+b.stack}},P=[],Q=!1,ca=!1,ka="img css script link audio radio".split(" "),
        S=[],D=0,E=[],A,da=!1,W=[],X=[],ea=!1,Da=function(a,b){return Array.isArray(a)?b(a.map(function(a){return{msg:"string"===typeof a.msg?a.msg:v(a.msg),level:a.level}})):b({msg:"string"===typeof a.msg?a.msg:v(a.msg),level:a.level})},aa=function(){},Ea=function(){function a(a){var b=this;this.config={version:1,delay:1500,repeat:5,random:1,url:"https://aegis.qq.com/collect",speedUrl:"https://aegis.qq.com/speed",customTimeUrl:"https://aegis.qq.com/speed/custom",whiteListUrl:"https://aegis.qq.com/aegis/whitelist",
            performanceUrl:"https://aegis.qq.com/speed/performance"};this.lifeCycle=new Aa;this.bean={};this._normalLogPipeline=I([H(this.config.delay,5),sa(this),Da,function(a,c){var d=b.config.beforeReport;"function"===typeof d&&(a=a.filter(function(a){return!1!==d(a)}));if(a.length)return b.lifeCycle.emit("beforeReport",a),c(a)},function(a){b.send({url:b.config.url,data:fa(a),method:"post",contentType:"application/x-www-form-urlencoded"},function(){var c=b.config.onReport;"function"===typeof c&&a.forEach(function(a){c(a)})})}]);
            this._timeMap={};this._customTimePipeline=I([H(this.config.delay),function(a){b.send({url:b.config.customTimeUrl+"?version="+b.config.version+"&payload="+encodeURIComponent(JSON.stringify({custom:a}))})}])}a.prototype.init=function(b,c){var d=this;this.setConfig(b);a.installedPlugins.forEach(function(a){a.call(d,c)});this.lifeCycle.emit("onInited")};a.prototype.setConfig=function(a){Object.assign(this.config,a);this.bean.id=this.config.id||"";this.bean.uin=this.config.uin||"";this.bean.version=this.config.version||
            0;return this.config};a.prototype.extendBean=function(a,c){this.bean[a]=c};a.use=function(b){-1===a.installedPlugins.indexOf(b)&&a.installedPlugins.push(b)};a.prototype.send=function(a,c,d){throw Error('You need to override "send" method');};a.prototype._sendSDKError=function(a){this.send({url:"https://aegis.qq.com/collect?id=1085&msg[0]="+encodeURIComponent(v(a))+"&level[0]=2&from="+this.config.id+"&count=1&version=1.5.15",addBean:!1,method:"get"})};a.prototype.info=function(a){this._normalLogPipeline({msg:a,
            level:f.INFO})};a.prototype.infoAll=function(a){this._normalLogPipeline({msg:a,level:f.INFO_ALL})};a.prototype.report=function(a){this._normalLogPipeline({msg:a,level:f.ERROR})};a.prototype.reportPv=function(a){a&&this.send({url:this.config.url+"/"+a})};a.prototype.reportTime=function(a,c){"string"!==typeof a?console.warn("reportTime \u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u5fc5\u987b\u4e3a\u5f00\u53d1\u8005\u5e73\u53f0\u7533\u8bf7\u7684 key \u503c"):"number"!==typeof c?console.warn("reportTime \u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5fc5\u987b\u4e3a number \u7c7b\u578b\u54df"):
            this._submitCustomTime(a,c)};a.prototype.time=function(a){"string"!==typeof a?console.warn("time \u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u5fc5\u987b\u4f20\u5165\u5f00\u53d1\u8005\u5e73\u53f0\u7533\u8bf7\u5230\u7684 key \u503c"):this._timeMap[a]?console.warn("Timer "+a+" already exists"):this._timeMap[a]=Date.now()};a.prototype.timeEnd=function(a){"string"!==typeof a?console.warn("timeEnd \u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u5fc5\u987b\u4f20\u5165\u5f00\u53d1\u8005\u5e73\u53f0\u7533\u8bf7\u5230\u7684 key \u503c"):
            this._timeMap[a]?(this._submitCustomTime(a,Date.now()-this._timeMap[a]),delete this._timeMap[a]):console.warn("Timer "+a+" does not exist")};a.prototype._submitCustomTime=function(a,c){this._customTimePipeline({name:a,duration:c})};a.installedPlugins=[];return a}(),Fa=function(a,b){if("string"!==typeof a)return"";if("object"===typeof b&&b){var c=Object.getOwnPropertyNames(b).map(function(a){var c=b[a];return a+"="+("string"===typeof c?encodeURIComponent(c):encodeURIComponent(JSON.stringify(c)))}).join("&").replace(/eval/gi,
            "evaI");return""+a+(-1===a.indexOf("?")?"?":"&")+c}return a},ba=navigator.userAgent.toLowerCase(),u;(function(a){a[a.android=1]="android";a[a.ios=2]="ios";a[a.other=100]="other"})(u||(u={}));var l;(function(a){a[a.unknown=0]="unknown";a[a.wifi=1]="wifi";a[a.net2g=2]="net2g";a[a.net3g=3]="net3g";a[a.net4g=4]="net4g"})(l||(l={}));var p=function(a){function b(c){var d=a.call(this,c)||this;d.send=function(a,b,c){if(a&&"string"===typeof a.url&&d.bean.id){var e=a.url;!1!==a.addBean&&(e=""+e+(-1===e.indexOf("?")?
        "?":"&")+d._bean);var g=a.method||"get",f=new XMLHttpRequest;f.__sendByAegis=!0;f.addEventListener("readystatechange",function(){4===f.readyState&&(400<=f.status?c&&c(f.response):b&&b(f.response))});"get"===g.toLocaleLowerCase()?(f.open("get",Fa(e,a.data)),f.send()):(f.open("post",e),a.contentType&&f.setRequestHeader("Content-Type",a.contentType),"string"===typeof a.data&&(a.data=a.data.replace(/eval/gi,"evaI")),f.send(a.data))}};d._speedLogPipeline=I([ta(),H(d.config.delay),function(a,b){var c=d.config.beforeReportSpeed;
        "function"===typeof c&&(a=a.filter(function(a){return!1!==c(a)}));if(a.length)return d.lifeCycle.emit("beforeReportSpeed",a),b(a)},function(a){d.send({url:""+d.config.speedUrl,method:"post",data:ua(a,d.bean)})}]);try{c.uin=c.uin||parseInt((document.cookie.match(/\buin=\D+(\d*)/)||[])[1],10)||parseInt((document.cookie.match(/\bilive_uin=\D*(\d+)/)||[])[1],10)||"",c.offlineLog&&d._initOfflineLog(c),d.init(c,b),d.extendBean("sessionId",b._sessionID),d.extendBean("platform",wa()),d._addNetworkTypeToBean()}catch(e){console.warn(e),
        console.log("%c\u4ee5\u4e0a\u9519\u8bef\u53d1\u751f\u5728\u521d\u59cb\u5316 Aegis \u7684\u8fc7\u7a0b\u4e2d\uff0c\u5c06\u4f1a\u5f71\u54cd\u60a8\u6b63\u5e38\u4f7f\u7528 Aegis\uff0c\n\u5efa\u8bae\u60a8\u8054\u7cfb aegis-helper\uff0c\u8fdb\u884c\u53cd\u9988\uff0c\u611f\u8c22\u60a8\u7684\u652f\u6301\u3002","color: red"),d._sendSDKError(e)}return d}n(b,a);Object.defineProperty(b.prototype,"_bean",{get:function(){var a=this;return Object.getOwnPropertyNames(this.bean).map(function(b){return b+"="+a.bean[b]}).join("&")+
            ("&from="+encodeURIComponent(location.href))},enumerable:!0,configurable:!0});b.prototype._initOfflineLog=function(a){ya("https://cdn-go.cn/vasdev/web_webpersistance_v2/latest/flog.core.min.js",a)};b.prototype._addNetworkTypeToBean=function(){var a=this,b=null;b=this;"undefined"===typeof this.bean.netType&&this.extendBean("netType",0);xa(function(c){a.extendBean("netType",c);setTimeout(b._addNetworkTypeToBean.bind(b),3E3)})};b.prototype.uploadLogs=function(a,b){void 0===a&&(a={});void 0===b&&(b={});
        this.lifeCycle.emit("uploadLogs",a,b)};b.useAsyncPlugin=function(a,d){void 0===d&&(d={});var c=d.exportsConstructor,f=void 0===c?"aegis-plugin-"+this.asyncPluginIndex++:c;c=d.onAegisInit;var h=void 0===c?function(){}:c;d=d.onAegisInitAndPluginLoaded;var k=void 0===d?function(){}:d;if("string"!==typeof a)throw new TypeError("\u5f02\u6b65\u63d2\u4ef6\u7684 url \u5fc5\u987b\u662f string \u7c7b\u578b");if("function"!==typeof h||"function"!==typeof k)throw new TypeError("onAegisInit\u3001onAegisInitAndPluginLoaded\u90fd\u5fc5\u987b\u662f\u51fd\u6570");
        this.use(function(){var c=this;try{h(this),b._asyncPlugin[a]?k(this,window[b._asyncPlugin[a]]):va(a,f,function(d){d||(b._asyncPlugin[a]=f,k(c,window[f]))})}catch(w){console.log("\u5728\u521d\u59cb\u5316\u63d2\u4ef6 "+a+" \u65f6\u53d1\u751f\u4ee5\u4e0b\u9519\u8bef\uff1a"),console.error(w)}})};b.__version__="1.5.15";b._sessionID="session-"+Date.now();b.asyncPluginIndex=0;b._asyncPlugin={};return b}(Ea);p.use(function(){P.push(this._normalLogPipeline);ia()});p.use(function(){this.config.reportApiSpeed&&
    (W.push(this._speedLogPipeline),X.push(this._normalLogPipeline),da||(da=!0,na(),oa()))});p.use(function(){N()&&this.config.reportAssetSpeed&&(S.push(this._speedLogPipeline),ca||(ca=!0,setInterval(ja,this.config.delay),performance.onresourcetimingbufferfull=function(){D=0;performance.clearResourceTimings()},window.document.addEventListener("error",function(a){a&&a.target&&a.srcElement&&(a=a.target||a.srcElement,a=a.src||a.href)&&(a={url:m(a),status:400,method:"get",type:"static",isHttps:k(a),urlQuery:m(a,
            !0),x5Type:L()},R(a))},!0)))});p.use(function(){var a=this;if(N())if(E.push(this.send),A)T(A,this);else try{la(function(b){var c=performance.timing;A={dnsLookup:c.domainLookupEnd-c.domainLookupStart,tcp:c.connectEnd-c.connectStart,ssl:0===c.secureConnectionStart?0:c.requestStart-c.secureConnectionStart,ttfb:c.responseStart-c.requestStart,contentDownload:c.responseEnd-c.responseStart,domParse:c.domInteractive-c.domLoading,resourceDownload:c.loadEventStart-c.domInteractive,firstScreenTiming:Math.floor(b)};
        T(A,a)})}catch(b){}});p.use(function(){var a=this;pa(function(b){a.bean.aid=b})});p.use(function(a){this.config.tjg&&(ea||(ea=!0,qa(a),ra(a)))});return p});